{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "bd7b8e8f_64ef4a50",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-09-26T19:22:29Z",
      "side": 1,
      "message": "Expanded the doc more.",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "70234104_fee0ade3",
        "filename": "apex/adbd.rc",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2024-09-26T19:48:57Z",
      "side": 1,
      "message": "do you actually need this? if adbd is setting tradeinmode to -1 itself and then exiting, you shouldn\u0027t?",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ce7deae7_3820e0a1",
        "filename": "apex/adbd.rc",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-09-27T00:25:38Z",
      "side": 1,
      "message": "On userdebug it\u0027s not needed, but I\u0027m worried that on user builds adb will just restart in non-TIM mode.",
      "parentUuid": "70234104_fee0ade3",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0d7a3470_51ed0e94",
        "filename": "apex/adbd.rc",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-10-01T00:37:12Z",
      "side": 1,
      "message": "\u003e I\u0027m worried that on user builds adb will just restart in non-TIM mode.\n\nIt is possible other code could hit `start adbd`. If the device is in trade-in-mode, should adbd detect this and refuse to start up?",
      "parentUuid": "ce7deae7_3820e0a1",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f1983968_c6dd5d71",
        "filename": "apex/adbd.rc",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-10-01T01:41:26Z",
      "side": 1,
      "message": "If the device is in trade-in mode, adbd *should* be started.",
      "parentUuid": "0d7a3470_51ed0e94",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "86e321d6_c2f698e7",
        "filename": "apex/adbd.rc",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2024-10-01T20:53:47Z",
      "side": 1,
      "message": "\u003e On userdebug it\u0027s not needed, but I\u0027m worried that on user builds adb will just restart in non-TIM mode.\n\ni\u0027m not sure i understand ... you need the \"what does `service.adb.tradeinmode` say?\" check in adbd regardless, no?",
      "parentUuid": "f1983968_c6dd5d71",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4c6d8e21_4c35f2b9",
        "filename": "apex/adbd.rc",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-10-01T23:35:49Z",
      "side": 1,
      "message": "Right, but the behavior is to start adb w/ the normal sepolicy if `service.adb.tradeinmode \u003d\u003d -1`. That\u0027s so userdebug builds can gracefully recover from failures. And on user builds, say the setcon() fails for some reason... we want adb to stop, to *not* restart. But if you then manually enable adb after SUW completes, you\u0027d want adb to start normally.\n\nI couldn\u0027t think of a good way to enforce this purely through C++.",
      "parentUuid": "86e321d6_c2f698e7",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e0d1f547_b23d27ca",
        "filename": "apex/adbd.rc",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-10-02T23:46:46Z",
      "side": 1,
      "message": "It sounds like if it stops here, something else would restart it. What restarts it?",
      "parentUuid": "4c6d8e21_4c35f2b9",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1d308bee_27412319",
        "filename": "apex/adbd.rc",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-10-02T23:50:25Z",
      "side": 1,
      "message": "init",
      "parentUuid": "e0d1f547_b23d27ca",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a91a77eb_952a2571",
        "filename": "apex/adbd.rc",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-10-03T02:32:49Z",
      "side": 1,
      "message": "\u0027stop adbd\u0027 sets it as SVC_DISABLED. So, something else would need to call \u0027start adbd\u0027 to get it to start again. What about \u0027restart adbd\u0027 instead? Even if something else did call \u0027start adbd\u0027 after the restart, it\u0027s a no-op.",
      "parentUuid": "1d308bee_27412319",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0b72928e_2d4a0791",
        "filename": "daemon/services.cpp",
        "patchSetId": 3
      },
      "lineNbr": 285,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2024-09-26T19:48:57Z",
      "side": 1,
      "message": "doesn\u0027t this need to come above the abb support?",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "aeb70b9f_4664799c",
        "filename": "daemon/services.cpp",
        "patchSetId": 3
      },
      "lineNbr": 285,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-09-27T00:25:38Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0b72928e_2d4a0791",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2a24b5e0_5d1ad10e",
        "filename": "daemon/tradeinmode.cpp",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2024-09-26T19:48:57Z",
      "side": 1,
      "message": "do you actually want FATAL here? or do you just want to exit? (because failure exit will count as a strike against the apex, and i _think_ the idea here is \"i\u0027m a new adbd apex running on a device too old to have trade-in mode\"?)",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9dbf918c_f6ff3e65",
        "filename": "daemon/tradeinmode.cpp",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-09-27T00:25:38Z",
      "side": 1,
      "message": "exit is fine, I think.",
      "parentUuid": "2a24b5e0_5d1ad10e",
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4780e678_667ac3aa",
        "filename": "daemon/tradeinmode.cpp",
        "patchSetId": 3
      },
      "lineNbr": 69,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2024-09-26T19:48:57Z",
      "side": 1,
      "message": "don\u0027t you need a \\s after this? otherwise if i can get a binary tradeinmode-evil onto the device, i can run that too?",
      "range": {
        "startLine": 69,
        "startChar": 39,
        "endLine": 69,
        "endChar": 50
      },
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "37ed5581_c8fb46e8",
        "filename": "daemon/tradeinmode.cpp",
        "patchSetId": 3
      },
      "lineNbr": 69,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-09-27T00:25:38Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4780e678_667ac3aa",
      "range": {
        "startLine": 69,
        "startChar": 39,
        "endLine": 69,
        "endChar": 50
      },
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3e85df58_312089ed",
        "filename": "docs/dev/adb_tradeinmode.md",
        "patchSetId": 3
      },
      "lineNbr": 31,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2024-09-26T19:48:57Z",
      "side": 1,
      "message": "link or something to grep for?",
      "range": {
        "startLine": 31,
        "startChar": 64,
        "endLine": 31,
        "endChar": 86
      },
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ea0c87d8_4499367a",
        "filename": "docs/dev/adb_tradeinmode.md",
        "patchSetId": 3
      },
      "lineNbr": 31,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-09-27T00:25:38Z",
      "side": 1,
      "message": "This is TBD, the framework parts aren\u0027t in yet. Once all those pieces are signed off we\u0027ll update the doc.",
      "parentUuid": "3e85df58_312089ed",
      "range": {
        "startLine": 31,
        "startChar": 64,
        "endLine": 31,
        "endChar": 86
      },
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "956f5ec3_ac0121a4",
        "filename": "docs/dev/adb_tradeinmode.md",
        "patchSetId": 3
      },
      "lineNbr": 32,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2024-09-26T19:48:57Z",
      "side": 1,
      "message": "link or something to grep for?",
      "range": {
        "startLine": 32,
        "startChar": 21,
        "endLine": 32,
        "endChar": 33
      },
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "05090089_988692fc",
        "filename": "docs/dev/adb_tradeinmode.md",
        "patchSetId": 3
      },
      "lineNbr": 32,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-09-27T00:25:38Z",
      "side": 1,
      "message": "ditto here",
      "parentUuid": "956f5ec3_ac0121a4",
      "range": {
        "startLine": 32,
        "startChar": 21,
        "endLine": 32,
        "endChar": 33
      },
      "revId": "4f790a55f226be42fdd003ce30ab587f79806c79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}